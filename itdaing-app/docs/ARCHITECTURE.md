# Itdaing App ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

> ğŸ“ í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œì˜ ì „ì²´ êµ¬ì¡° ë° ë°ì´í„° íë¦„

## ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Frontend (React)                       â”‚
â”‚                  http://localhost:3000                   â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Pages      â”‚  â”‚  Components  â”‚  â”‚    Hooks     â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  HomePage    â”‚  â”‚  EventCard   â”‚  â”‚  usePopups   â”‚  â”‚
â”‚  â”‚  LoginPage   â”‚  â”‚  Header      â”‚  â”‚  useMaster   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                 â”‚                 â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                           â”‚                              â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                  â”‚  API Services   â”‚                     â”‚
â”‚                  â”‚  (Axios Client) â”‚                     â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTP (Proxy: /api â†’ :8080)
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Backend (Spring Boot)                        â”‚
â”‚              http://localhost:8080                        â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Controllers  â”‚  â”‚   Services   â”‚  â”‚  Repository  â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚
â”‚  â”‚ PopupApi     â”‚â”€â–ºâ”‚ PopupService â”‚â”€â–ºâ”‚ PopupRepo    â”‚  â”‚
â”‚  â”‚ AuthApi      â”‚  â”‚ AuthService  â”‚  â”‚ UserRepo     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                 â”‚           â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                   â”‚     Redis (Cache)               â”‚   â”‚
â”‚                   â”‚     Port: 6379                  â”‚   â”‚
â”‚                   â”‚  - Session Storage              â”‚   â”‚
â”‚                   â”‚  - API Response Cache           â”‚   â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                             â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚                   â”‚   PostgreSQL    â”‚                    â”‚
â”‚                   â”‚   Port: 5432    â”‚                    â”‚
â”‚                   â”‚  - ë©”ì¸ ë°ì´í„°   â”‚                    â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ë°±ì—”ë“œ êµ¬ì„± ìš”ì†Œ

### 1. Spring Boot Application (Port: 8080)
- **ì—­í• **: RESTful API ì œê³µ
- **í™˜ê²½**: `local` ë˜ëŠ” `prod` í”„ë¡œíŒŒì¼
- **ì‹¤í–‰ ë°©ë²•**: `java -jar app.jar` ë˜ëŠ” `./gradlew bootRun`

### 2. Redis Server (Port: 6379)
- **ì—­í• **: ìºì‹± ë° ì„¸ì…˜ ê´€ë¦¬
- **ì‚¬ìš© ëª©ì **:
  - API ì‘ë‹µ ìºì‹± (íŒì—… ëª©ë¡, ì¹´í…Œê³ ë¦¬ ë“±)
  - ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ (JWT refresh token)
  - ì†ë„ ì œí•œ (Rate Limiting)
- **í™•ì¸ ë°©ë²•**: `redis-cli ping` â†’ `PONG` ì‘ë‹µ
- **ìƒíƒœ í™•ì¸**: `ps aux | grep redis`

### 3. PostgreSQL Database (Port: 5432)
- **ì—­í• **: ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤
- **ìŠ¤í‚¤ë§ˆ**:
  - `users` - ì‚¬ìš©ì ì •ë³´
  - `popups` - íŒì—… ì •ë³´
  - `reviews` - ë¦¬ë·°
  - `wishlists` - ì°œí•˜ê¸°
  - `zones`, `cells` - ì§€ë¦¬ì  ìœ„ì¹˜ ì •ë³´

## ë°ì´í„° íë¦„

### 1. íŒì—… ëª©ë¡ ì¡°íšŒ (í™ˆí˜ì´ì§€)

```
[Frontend]
  â”‚
  â”œâ”€ 1. usePopups() Hook í˜¸ì¶œ
  â”‚     â””â”€ React Queryë¡œ ë°ì´í„° ìš”ì²­
  â”‚
  â”œâ”€ 2. GET /api/popups
  â”‚     â””â”€ Axios Client â†’ Vite Proxy
  â”‚
  â–¼
[Backend]
  â”‚
  â”œâ”€ 3. PopupController.getPopups()
  â”‚     â””â”€ @GetMapping("/api/popups")
  â”‚
  â”œâ”€ 4. PopupService.getPopups()
  â”‚     â”‚
  â”‚     â”œâ”€ Redis ìºì‹œ í™•ì¸
  â”‚     â”‚   â””â”€ ìºì‹œ ìˆìœ¼ë©´ ì¦‰ì‹œ ë°˜í™˜
  â”‚     â”‚
  â”‚     â””â”€ ìºì‹œ ì—†ìœ¼ë©´ DB ì¡°íšŒ
  â”‚         â””â”€ PostgreSQL Query
  â”‚             â””â”€ Redisì— ìºì‹œ ì €ì¥ (TTL: 5ë¶„)
  â”‚
  â”œâ”€ 5. Response ë°˜í™˜
  â”‚     â””â”€ ApiResponse<List<PopupDto>>
  â”‚
  â–¼
[Frontend]
  â”‚
  â””â”€ 6. React Query ìºì‹±
        â””â”€ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§
```

### 2. ë¡œê·¸ì¸ ê³¼ì •

```
[Frontend]
  â”‚
  â”œâ”€ 1. LoginPageì—ì„œ í¼ ì œì¶œ
  â”‚     â””â”€ loginId, password
  â”‚
  â”œâ”€ 2. POST /api/auth/login
  â”‚     â””â”€ { loginId, password }
  â”‚
  â–¼
[Backend]
  â”‚
  â”œâ”€ 3. AuthController.login()
  â”‚     â”‚
  â”‚     â”œâ”€ 4. ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
  â”‚     â”‚     â””â”€ BCryptPasswordEncoder
  â”‚     â”‚
  â”‚     â”œâ”€ 5. JWT í† í° ìƒì„±
  â”‚     â”‚     â”œâ”€ Access Token (15ë¶„)
  â”‚     â”‚     â””â”€ Refresh Token (14ì¼)
  â”‚     â”‚
  â”‚     â””â”€ 6. Redisì— Refresh Token ì €ì¥
  â”‚           â””â”€ Key: "refresh:{userId}"
  â”‚
  â”œâ”€ 7. Response ë°˜í™˜
  â”‚     â””â”€ { accessToken, refreshToken, user }
  â”‚
  â–¼
[Frontend]
  â”‚
  â”œâ”€ 8. localStorageì— í† í° ì €ì¥
  â”‚     â”œâ”€ accessToken
  â”‚     â””â”€ refreshToken
  â”‚
  â””â”€ 9. Zustand Store ì—…ë°ì´íŠ¸
        â””â”€ authStore.login()
```

### 3. API í˜¸ì¶œ (ì¸ì¦ í•„ìš”)

```
[Frontend]
  â”‚
  â”œâ”€ 1. GET /api/users/me
  â”‚     â””â”€ Header: Authorization: Bearer <accessToken>
  â”‚
  â–¼
[Backend]
  â”‚
  â”œâ”€ 2. JWT ê²€ì¦
  â”‚     â”‚
  â”‚     â”œâ”€ Access Token ìœ íš¨ â†’ ê³„ì†
  â”‚     â”‚
  â”‚     â””â”€ Access Token ë§Œë£Œ â†’ 401 Unauthorized
  â”‚
  â–¼
[Frontend]
  â”‚
  â”œâ”€ 3. Axios Interceptor (401 ì—ëŸ¬ ê°ì§€)
  â”‚     â”‚
  â”‚     â”œâ”€ 4. POST /api/auth/refresh
  â”‚     â”‚     â””â”€ { refreshToken }
  â”‚     â”‚
  â”‚     â–¼
  â”‚  [Backend]
  â”‚     â”‚
  â”‚     â”œâ”€ 5. Redisì—ì„œ Refresh Token í™•ì¸
  â”‚     â”‚     â””â”€ Key: "refresh:{userId}"
  â”‚     â”‚
  â”‚     â”œâ”€ 6. ìƒˆ Access Token ë°œê¸‰
  â”‚     â”‚     â””â”€ ìƒˆ Refresh Token ë°œê¸‰ (ì„ íƒ)
  â”‚     â”‚
  â”‚     â””â”€ 7. Response ë°˜í™˜
  â”‚           â””â”€ { accessToken, refreshToken }
  â”‚
  â”œâ”€ 8. localStorage ì—…ë°ì´íŠ¸
  â”‚     â””â”€ ìƒˆ í† í° ì €ì¥
  â”‚
  â””â”€ 9. ì›ë˜ ìš”ì²­ ì¬ì‹œë„
        â””â”€ GET /api/users/me (ìƒˆ í† í° ì‚¬ìš©)
```

## ìºì‹± ì „ëµ

### Redis ìºì‹œ ì‚¬ìš© íŒ¨í„´

| ë°ì´í„° íƒ€ì… | ìºì‹œ í‚¤ | TTL | ì´ìœ  |
|------------|---------|-----|------|
| íŒì—… ëª©ë¡ | `popups:list:{filters}` | 5ë¶„ | ìì£¼ ì¡°íšŒë˜ì§€ë§Œ ì‹¤ì‹œê°„ì„± ë¶ˆí•„ìš” |
| íŒì—… ìƒì„¸ | `popup:{id}` | 10ë¶„ | ìƒì„¸ ì •ë³´ëŠ” ëœ ìì£¼ ë³€ê²½ë¨ |
| ì¹´í…Œê³ ë¦¬ | `categories:all` | 1ì‹œê°„ | ê±°ì˜ ë³€ê²½ë˜ì§€ ì•ŠìŒ |
| ì‚¬ìš©ì ì„¸ì…˜ | `refresh:{userId}` | 14ì¼ | Refresh Token ìœ ì§€ |
| Rate Limit | `rate:{ip}:{endpoint}` | 1ë¶„ | API ê³¼ìš© ë°©ì§€ |

### React Query ìºì‹±

```javascript
// usePopups.js
export const usePopups = (filters) => {
  return useQuery({
    queryKey: ['popups', filters],
    queryFn: () => fetchPopups(filters),
    staleTime: 5 * 60 * 1000,  // 5ë¶„
    cacheTime: 30 * 60 * 1000, // 30ë¶„
  });
};
```

## í™˜ê²½ë³„ ì„¤ì •

### Local ê°œë°œ í™˜ê²½

```yaml
# Backend: application-local.yml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/itdaing_local
  redis:
    host: localhost
    port: 6379
  profiles:
    active: local
```

```env
# Frontend: .env (ì„ íƒ)
VITE_API_BASE_URL=http://localhost:8080
VITE_KAKAO_MAP_KEY=YOUR_KEY_HERE
```

### Production í™˜ê²½

```bash
# Backend: prod.env (AWS Parameter Storeì—ì„œ ìë™ ìƒì„±)
SPRING_DATASOURCE_URL=jdbc:postgresql://itdaing-db.xxx.rds.amazonaws.com:5432/itdaing-db
SPRING_DATA_REDIS_HOST=itdaing-redis.xxx.cache.amazonaws.com
SPRING_DATA_REDIS_PORT=6379
```

## ì„œë¹„ìŠ¤ ì‹œì‘ ìˆœì„œ

### í•„ìˆ˜ ì‹¤í–‰ ìˆœì„œ

1. **PostgreSQL** (í•­ìƒ ì‹¤í–‰ ì¤‘)
   ```bash
   # ë¡œì»¬: Docker ë˜ëŠ” ë„¤ì´í‹°ë¸Œ ì„¤ì¹˜
   # AWS: RDS ìë™ ê´€ë¦¬
   ```

2. **Redis** (í•­ìƒ ì‹¤í–‰ ì¤‘)
   ```bash
   # ë¡œì»¬ í™•ì¸
   ps aux | grep redis
   redis-cli ping  # PONG ì‘ë‹µ í™•ì¸
   ```

3. **Backend (Spring Boot)**
   ```bash
   cd /home/ubuntu/itdaing
   java -jar app.jar
   # Health Check: http://localhost:8080/actuator/health
   ```

4. **Frontend (Vite)**
   ```bash
   cd /home/ubuntu/itdaing-app
   nvm use
   npm run dev
   # ì ‘ì†: http://localhost:3000
   ```

## API ì‘ë‹µ í˜•ì‹

### ì„±ê³µ ì‘ë‹µ

```json
{
  "success": true,
  "data": {
    "id": 1,
    "title": "íŒì—… ì œëª©",
    "description": "ì„¤ëª…"
  }
}
```

### ì—ëŸ¬ ì‘ë‹µ

```json
{
  "success": false,
  "error": {
    "code": "INVALID_INPUT",
    "message": "ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤",
    "fieldErrors": [
      {
        "field": "email",
        "message": "ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤"
      }
    ]
  }
}
```

## ì„±ëŠ¥ ìµœì í™”

### 1. Redis ìºì‹±
- ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„°ëŠ” Redisì— ìºì‹±
- ìºì‹œ íˆíŠ¸ìœ¨: í‰ê·  80% ì´ìƒ ëª©í‘œ

### 2. React Query ìºì‹±
- ì„œë²„ ìƒíƒœë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìºì‹±
- ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ë°©ì§€

### 3. Vite Proxy
- CORS ë¬¸ì œ í•´ê²°
- ê°œë°œ í™˜ê²½ì—ì„œ ì›í™œí•œ API í˜¸ì¶œ

### 4. ì´ë¯¸ì§€ ìµœì í™”
- S3ì— ì´ë¯¸ì§€ ì €ì¥
- CDNì„ í†µí•œ ë¹ ë¥¸ ì „ì†¡ (í–¥í›„ ê³„íš)

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. JWT í† í°
- Access Token: ì§§ì€ ìœ íš¨ê¸°ê°„ (15ë¶„)
- Refresh Token: Redisì— ì €ì¥ (14ì¼)
- localStorage ì‚¬ìš© (XSS ì£¼ì˜)

### 2. Redis ì„¸ì…˜
- Refresh Tokenì„ Redisì— ì €ì¥
- ë¡œê·¸ì•„ì›ƒ ì‹œ Redisì—ì„œ ì œê±°

### 3. CORS ì„¤ì •
- í”„ë¡œë•ì…˜: íŠ¹ì • ë„ë©”ì¸ë§Œ í—ˆìš©
- ê°œë°œ: localhost:3000ë§Œ í—ˆìš©

### 4. Rate Limiting
- Redisë¥¼ ì´ìš©í•œ API í˜¸ì¶œ ì œí•œ
- IP ê¸°ë°˜ ì œí•œ (1ë¶„ì— 100íšŒ)

## ëª¨ë‹ˆí„°ë§

### Backend Health Check
```bash
curl http://localhost:8080/actuator/health
```

### Redis ìƒíƒœ í™•ì¸
```bash
redis-cli ping
redis-cli info stats
```

### PostgreSQL ì—°ê²° í™•ì¸
```bash
psql -h localhost -U itdaing_user -d itdaing_local -c "SELECT 1;"
```

## ê´€ë ¨ ë¬¸ì„œ

- [QUICK_START.md](../QUICK_START.md) - ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
- [UBUNTU_DEVELOPMENT_GUIDE.md](../UBUNTU_DEVELOPMENT_GUIDE.md) - Ubuntu ê°œë°œ ê°€ì´ë“œ
- [DEPLOYMENT_STATUS.md](./DEPLOYMENT_STATUS.md) - ë°°í¬ ìƒíƒœ
- [TEST_ACCOUNTS.md](./TEST_ACCOUNTS.md) - í…ŒìŠ¤íŠ¸ ê³„ì •

